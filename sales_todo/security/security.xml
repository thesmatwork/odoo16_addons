<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- ============================= -->
        <!-- Groups -->
        <!-- ============================= -->

        <!-- Sales Todo User Group -->
        <record id="group_sales_todo_user" model="res.groups">
            <field name="name">Sales Todo User</field>
            <!-- Category removed for full compatibility -->
            <field name="implied_ids" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
        </record>

        <!-- Sales Todo Manager Group -->
        <record id="group_sales_todo_manager" model="res.groups">
            <field name="name">Sales Todo Manager</field>
            <!-- Category removed for full compatibility -->
            <field name="implied_ids" eval="[(4, ref('group_sales_todo_user'))]"/>
        </record>

        <!-- ============================= -->
        <!-- Record Rules -->
        <!-- ============================= -->

        <!-- Rule: Sales Todo User sees only their own todos -->
        <record id="sales_todo_user_rule" model="ir.rule">
            <field name="name">Sales Todo User Rule</field>
            <field name="model_id" ref="model_sales_todo"/>
            <field name="domain_force">[('assigned_user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_sales_todo_user'))]"/>
        </record>

        <!-- Rule: Sales Todo Manager sees all todos -->
        <record id="sales_todo_manager_rule" model="ir.rule">
            <field name="name">Sales Todo Manager Rule</field>
            <field name="model_id" ref="model_sales_todo"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_sales_todo_manager'))]"/>
        </record>

        <!-- Rule: Sales Message User sees messages where they are recipients -->
        <record id="sales_message_user_rule" model="ir.rule">
            <field name="name">Sales Message User Rule</field>
            <field name="model_id" ref="model_sales_message"/>
            <field name="domain_force">[('recipient_ids', 'in', [user.id])]</field>
            <field name="groups" eval="[(4, ref('group_sales_todo_user'))]"/>
        </record>

    </data>
</odoo>
